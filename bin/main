#!/usr/bin/env ruby
require_relative '../lib/check_game_result'
class TicTacToe
  attr_reader :board

  def initialize
    @board = ['', '', '', '', '', '', '', '', '']
  end

  def board_interface
    puts "#{@board[0]} | #{@board[1]}  | #{@board[2]}"
    puts '________'
    puts "#{@board[3]} | #{@board[4]}  | #{@board[5]}"
    puts '________'
    puts "#{@board[6]} | #{@board[7]}  | #{@board[8]}"
  end

  def winer
    check_game_result = CheckGameResult.new(@board)
    check_game_result.win
  end

  def game_numbers
    @all_numbers = (1..9).to_a
    @already_used = [0]
  end

  def avaliable_inputs
    @already_used << @player_number if (1..9).cover?(@player_number)
    @avaliable = @all_numbers - @already_used
    p "These numbers are avaliable for next player #{@avaliable}"
  end

  def player_input
    @player_number = gets.chomp.to_i
  end

  def win_methods
    player_input
    invalid
    avaliable_inputs
    board_interface
  end

  def start_game
    p 'Type number from 1 to 9'
    game_numbers
    until winer
      win_methods
      break if winer

      if @avaliable.empty?
        p 'draw'
        break
      end
    end
  end

  def invalid
    if @already_used.include?(@player_number) || !(1..9).cover?(@player_number)
      p 'This is an invalid move.'
    else
      @already_used.uniq.each_index do |index|
        @board[@player_number - 1] = index.odd? ? 'O' : 'X'
      end
    end
  end
end

game = TicTacToe.new
p game.start_game
